# Ëøô‰∏™Âå∫ÊÆµÁî±ÂºÄÂèëËÄÖÁºñÂÜô,Êú™ÁªèÂÖÅËÆ∏Á¶ÅÊ≠¢AI‰øÆÊîπ

## 2025-05-11 14:01 - Ran `check_docs.js` script

*   **Time of execution**: 2025-05-11 14:01:50 - (refer to terminal output for end time)
*   **Script**: `node check_docs.js` (from `siyuan-kernelApi-docs/scripts`)
*   **Key Findings**:
    *   Found 407 API definitions in `router.go`.
    *   **69 APIs are missing documentation files** (down from 70).
    *   1 orphaned file still exists: `transactions/transactions.html`.
    *   All group `index.html` files are consistent with API definitions.
*   **Next API to document** (based on the new list): `/api/setting/addVirtualBlockRefExclude`.

---

## 2025-05-11 14:14

- **‰∏∫ `/api/setting/addVirtualBlockRefExclude` ÂàõÂª∫ÊñáÊ°£**:
    - ÈòÖËØª `siyuan/kernel/api/setting.go` ‰∏≠ `addVirtualBlockRefExclude` ÂáΩÊï∞ÁöÑÊ∫êÁ†Å (Á¨¨ 68 Ë°å)„ÄÇ
    - ÈòÖËØª `siyuan/kernel/api/router.go` ‰∏≠ËØ• API ÁöÑË∑ØÁî±ÂÆö‰πâ (Á¨¨ 353 Ë°å)„ÄÇ
    - **Á°ÆËÆ§‰ø°ÊÅØ**:
        - HTTP Method: `POST`.
        - Êé•Âè£Ë∑ØÂæÑ: `/api/setting/addVirtualBlockRefExclude`.
        - ËÆ§ËØÅÁä∂ÊÄÅ: "ÈúÄË¶ÅËÆ§ËØÅ" (`model.CheckAuth`), "ÈúÄË¶ÅÁÆ°ÁêÜÂëò" (`model.CheckAdminRole`), "Ê£ÄÊü•Âè™ËØªÊ®°Âºè" (`model.CheckReadonly`).
        - Êé•Âè£ÊèèËø∞: "Ê∑ªÂä†‰∏ÄÊâπÂÖ≥ÈîÆËØçÂà∞ËôöÊãüÂùóÂºïÁî®ÁöÑÊéíÈô§ÂàóË°®‰∏≠„ÄÇÁî®‰∫é‰ºòÂåñËôöÊãüÂºïÁî®ÁöÑÁõ∏ÂÖ≥ÊÄß„ÄÇÊàêÂäüÂêéÂπøÊí≠ setConf ‰∫ã‰ª∂„ÄÇÂú®Âè™ËØªÊ®°Âºè‰∏ãÁ¶ÅÊ≠¢„ÄÇ"
        - ËØ∑Ê±ÇÂèÇÊï∞ (JSON Body):
            - `keywords` (string[], ÂøÖÈúÄ) - Ë¶ÅÊ∑ªÂä†Âà∞ÊéíÈô§ÂàóË°®ÁöÑÂÖ≥ÈîÆËØçÊï∞ÁªÑ„ÄÇ
        - ËøîÂõûÂÄº (JSON): Ê†áÂáÜÁªìÊûÑ `code`, `msg`, `data` (ÊàêÂäüÊó∂ `data` ‰∏∫ `null`).
    - ÂàõÂª∫‰∫ÜÊñ∞ÁöÑÊñáÊ°£Êñá‰ª∂ `siyuan-kernelApi-docs/setting/addVirtualBlockRefExclude.html`ÔºåÂåÖÂê´Âú®Á∫øÊµãËØïÂå∫„ÄÇ
    - ÊñáÊ°£‰∏≠ÂåÖÂê´‰∫ÜÊé•Âè£ÊèèËø∞„ÄÅÂèÇÊï∞„ÄÅËøîÂõûÂÄºÂèäÁ§∫‰æã„ÄÇ
- **‰∏ã‰∏ÄÊ≠•**: ËøêË°å `check_docs.js` Á°ÆËÆ§‰∏ã‰∏Ä‰∏™Áº∫Â§±ÁöÑ API Âπ∂ÁªßÁª≠Â§ÑÁêÜ„ÄÇ

---

## 2025-05-11 14:32 - Refactored AInote.md

- Ê†πÊçÆÂì•Âì•ÁöÑÊåáÁ§∫ÔºåÂ∞Ü‰∏ª `AInote.md` Êñá‰ª∂ËøõË°å‰∫ÜÊãÜÂàÜ„ÄÇ
- **Êìç‰ΩúËØ¶ÊÉÖ**:
    - Â∞ÜÂéü `AInote.md` ‰∏≠ÁöÑÊó•ÂøóÊù°ÁõÆÊåâÊó•Êúü (`YYYY-MM-DD`) ÊãÜÂàÜÂà∞ÂçïÁã¨ÁöÑÊñá‰ª∂‰∏≠„ÄÇ
    - ÂàõÂª∫‰∫Ü‰ª•‰∏ãÊØèÊó•Êó•ÂøóÊñá‰ª∂:
        - `AInote-2025-05-10.md`
        - `AInote-2025-05-11.md` (This entry refers to the file before this current refactoring)
    - ÊØè‰∏™ÊØèÊó•Êó•ÂøóÊñá‰ª∂ÈÉΩ‰øùÁïô‰∫ÜÈ°∂ÈÉ®ÁöÑÂºÄÂèëËÄÖË¶ÅÊ±ÇÂå∫Âùó„ÄÇ
    - ‰∏ª `AInote.md` Êñá‰ª∂Â∑≤Êõ¥Êñ∞‰∏∫Á¥¢ÂºïÊñá‰ª∂ÔºåÂåÖÂê´ÊåáÂêëÂêÑ‰∏™ÊØèÊó•Êó•ÂøóÊñá‰ª∂ÁöÑÈìæÊé•„ÄÇ
- **ÂéüÂõ†**: ‰∏ª `AInote.md` Êñá‰ª∂ÂÜÖÂÆπËøáÈïøÔºàÁ∫¶600Ë°åÔºâÔºå‰∏çÊòìÁÆ°ÁêÜÂíåÊü•ÈòÖ„ÄÇ
- **ÂêéÁª≠**: ‰ªäÊó•ÂêéÁª≠Êó•ÂøóÂ∞ÜÁªßÁª≠ËÆ∞ÂΩïÂú®Êú¨Êñá‰ª∂ (`AInote-2025-05-11-part2.md`)„ÄÇ

---

**Timestamp:** 2025-05-11 16:03:32 GMT+0800

**Action:** Ran `check_docs.js` script.

**Summary of Findings:**
*   API definitions in `router.go`: 407
*   APIs missing documentation: 56
*   Orphaned documentation files: 1 (`transactions/transactions.html`)
*   Group `index.html` files: Consistent with API definitions.

**Next API to document:** `/api/setting/setExport` (based on the script output).

---

**Timestamp:** 2025-05-11 16:06:15 GMT+0800

**API Processed:** `/api/setting/setExport`

**Summary:** Created HTML documentation for the `/api/setting/setExport` API endpoint.

**Details:**
*   **API Endpoint:** `/api/setting/setExport`
*   **HTTP Method:** `POST`
*   **Authentication:** `model.CheckAuth`, `model.CheckAdminRole`, `model.CheckReadonly`.
*   **Go Function:** `setExport` in `siyuan/kernel/api/setting.go`.
*   **Associated Config Struct:** `conf.Export` in `siyuan/kernel/conf/export.go`.
*   **Request Parameters (JSON Body):** A complete `conf.Export` object. Key fields include:
    *   `paragraphBeginningSpace` (boolean)
    *   `addTitle` (boolean)
    *   `blockRefMode` (number)
    *   `blockEmbedMode` (number)
    *   `pandocBin` (string)
    *   `markdownYFM` (boolean)
    *   `pdfFooter` (string)
    *   (And others related to watermarks, templates, etc.)
*   **Functionality:** Updates the global export configurations. Validates `pandocBin` if provided.
*   **Response:** Standard structure, with `data` containing the updated `Export` object on success.
*   **Action:** Created `siyuan-kernelApi-docs/setting/setExport.html`.
    *   The documentation includes a detailed table of all parameters from `conf.Export`.
    *   An online test area is provided, with a helper button to load current export settings from `/api/system/getConf` to prepopulate the request body.
    *   Fixed linter errors related to JavaScript string formatting in the generated HTML.

**Next Step:** Run `check_docs.js` to identify the next missing API and continue documentation.

---
## 2025-05-11 16:12 - Ran `check_docs.js` script

**Timestamp before script:** 2025-05-11 16:12:28
**Timestamp after script:** 2025-05-11 16:12:40

**Execution:**
- Command: `node check_docs.js`
- Working directory: `D:\siyuan\siyuan-kernelApi-docs\scripts`

**Result:**
- API definitions: 407
- Missing API docs: 54
- Orphaned docs: 1 (`transactions/transactions.html` - this seems to be a persistent one, maybe we should check it later if it's not automatically handled by fixing missing docs or if it's a real orphan)

**Full output:**
```
PS D:\siyuan\siyuan-kernelApi-docs\scripts> node check_docs.js

üîÑ Ê≠£Âú®Â∞ùËØïÊõ¥Êñ∞Êú¨Âú∞ÊÄùÊ∫ê‰ªìÂ∫ì: D:\siyuan\siyuan
   ÂàáÊç¢Âà∞ÁõÆÂΩï: D:\siyuan\siyuan
‚úÖ Êú¨Âú∞ÊÄùÊ∫ê‰ªìÂ∫ìÊõ¥Êñ∞ÊàêÂäü:
   (Êó†Êõ¥Êñ∞ÂÜÖÂÆπ)

‚ÑπÔ∏è Â∞Ü‰ªéÊú¨Âú∞Ë∑ØÂæÑËØªÂèñ router.go: D:\siyuan\siyuan\kernel\api\router.go

üîç ‰ªé Êú¨Âú∞Êñá‰ª∂ router.go ‰∏≠ÊâæÂà∞ 407 ‰∏™ÊúâÊïà API/WS ÂÆö‰πâÔºåÂàÜÂ∏ÉÂú® 44 ‰∏™ÂàÜÁ±ª‰∏≠„ÄÇ

üöÄ ÂºÄÂßãÂèåÈáçÊ†°È™å API ÊñáÊ°£Ë¶ÜÁõñÊÉÖÂÜµ...

üìÇ ÂºÄÂßãÊ£ÄÊü• API Êñá‰ª∂ÁªìÊûÑ (‰∏ÄÂØπ‰∏ÄÂåπÈÖç)...
   Êâ´Êèè‰∫Ü 49 ‰∏™Áâ©ÁêÜÂ≠êÁõÆÂΩï‰∏≠ÁöÑ 353 ‰∏™ÈùûÁ¥¢Âºï HTML Êñá‰ª∂.
   üö® Êñá‰ª∂ÁªìÊûÑÊ£ÄÊü•ÔºöÂèëÁé∞ 54 ‰∏™ API Áº∫Â∞ëÂØπÂ∫îÁöÑÊñáÊ°£Êñá‰ª∂:
     - /api/setting/setFlashcard
     - /api/setting/setKeymap
     - /api/setting/setPublish
     - /api/setting/setSearch
     - /api/setting/setSnippet
     - /api/storage/getCriteria
     - /api/storage/getRecentDocs
     - /api/storage/removeCriterion
     - /api/storage/removeLocalStorageVals
     - /api/storage/setCriterion
     - /api/storage/setLocalStorageVal
     - /api/sync/createCloudSyncDir
     - /api/sync/exportSyncProviderS3
     - /api/sync/exportSyncProviderWebDAV
     - /api/sync/getBootSync
     - /api/sync/getSyncInfo
     - /api/sync/importSyncProviderS3
     - /api/sync/importSyncProviderWebDAV
     - /api/sync/listCloudSyncDir
     - /api/sync/performBootSync
     - /api/sync/performSync
     - /api/sync/removeCloudSyncDir
     - /api/sync/setCloudSyncDir
     - /api/sync/setSyncEnable
     - /api/sync/setSyncGenerateConflictDoc
     - /api/sync/setSyncInterval
     - /api/sync/setSyncMode
     - /api/sync/setSyncPerception
     - /api/sync/setSyncProvider
     - /api/sync/setSyncProviderLocal
     - /api/sync/setSyncProviderS3
     - /api/sync/setSyncProviderWebDAV
     - /api/system/addMicrosoftDefenderExclusion
     - /api/system/exportConf
     - /api/system/getCaptcha
     - /api/system/getChangelog
     - /api/system/getConf
     - /api/system/getEmojiConf
     - /api/system/getWorkspaceInfo
     - /api/system/getWorkspaces
     - /api/system/ignoreAddMicrosoftDefenderExclusion
     - /api/system/importConf
     - /api/system/loginAuth
     - /api/system/logoutAuth
     - /api/system/reloadUI
     - /api/system/setAPIToken
     - /api/system/setAccessAuthCode
     - /api/system/setDownloadInstallPkg
     - /api/system/uiproc
     - /api/ui/reloadAttributeView
     - /api/ui/reloadFiletree
   ‚úÖ Á¥¢ÂºïÊ£ÄÊü• [account]: index.html ÂÜÖÂÆπ‰∏é API ÂÆö‰πâ‰∏ÄËá¥ (5 ‰∏™)„ÄÇ
   ... (omitted consistent index checks for brevity) ...
   ‚úÖ ÊâÄÊúâÂàÜÁªÑÁ¥¢ÂºïÂùá‰∏é‰ª£Á†ÅÂÆö‰πâ‰∏ÄËá¥Ôºå‰∏îÊó†Â≠§Á´ãÁ¥¢Âºï„ÄÇ

üèÅ ÂèåÈáçÊ†°È™åÂÆåÊàê„ÄÇÊÄªÁªìÔºö
   - üî¥ 54 ‰∏™ API Áº∫Â∞ëÂØπÂ∫îÁöÑÊñáÊ°£Êñá‰ª∂„ÄÇ
   - üü° 1 ‰∏™Â≠§Á´ãÁöÑÊñáÊ°£Êñá‰ª∂ÈúÄË¶ÅÊ∏ÖÁêÜ„ÄÇ
   - ‚úÖ Ê≤°ÊúâÂèëÁé∞Â≠§Á´ãÁöÑ index.html Êñá‰ª∂„ÄÇ
   ËØ∑Ê†πÊçÆ‰∏äÈù¢ÁöÑËØ¶ÁªÜÊä•ÂëäËøõË°åÂ§ÑÁêÜ„ÄÇ
PS D:\siyuan\siyuan-kernelApi-docs\scripts>
```

**Next Step:** Process the next missing API: `/api/setting/setFlashcard`.

---
## 2025-05-11 16:15 - API Doc: `/api/setting/setFlashcard`

**Timestamps:**
- Start: 2025-05-11 16:14:09
- End: 2025-05-11 16:15:19

**API Processed:** `/api/setting/setFlashcard`

**Summary:** Created HTML documentation for the `/api/setting/setFlashcard` API endpoint.

**Details:**
*   **API Endpoint:** `/api/setting/setFlashcard`
*   **HTTP Method:** `POST`
*   **Authentication:** `model.CheckAuth`, `model.CheckAdminRole`, `model.CheckReadonly`.
*   **Go Function:** `setFlashcard` in `siyuan/kernel/api/setting.go` (Lines 225-250).
*   **Associated Config Struct:** `conf.Flashcard` in `siyuan/kernel/conf/flashcard.go`.
*   **Request Parameters (JSON Body):** A complete `conf.Flashcard` object. Key fields include:
    *   `newCardLimit` (number, default: 20) - Min 0.
    *   `reviewCardLimit` (number, default: 200) - Min 0.
    *   `mark` (boolean, default: true)
    *   `list` (boolean, default: true)
    *   `superBlock` (boolean, default: true)
    *   `heading` (boolean, default: true)
    *   `deck` (boolean, default: false)
    *   `reviewMode` (number, default: 0) - 0:Ê∑∑Âêà, 1:Êñ∞Âç°‰ºòÂÖà, 2:ÊóßÂç°‰ºòÂÖà.
    *   `requestRetention` (number, default: FSRS default)
    *   `maximumInterval` (number, default: FSRS default)
    *   `weights` (string, default: FSRS default) - Comma-separated floats.
*   **Functionality:** Updates the global flashcard configurations. Validates `newCardLimit` and `reviewCardLimit` to be non-negative.
*   **Response:** Standard structure, with `data` containing the updated `Flashcard` object on success.
*   **Action:** Created `siyuan-kernelApi-docs/setting/setFlashcard.html`.
    *   The documentation includes a detailed table of all parameters from `conf.Flashcard` along with their default values and descriptions.
    *   An online test area is provided, with a helper button to load current flashcard settings from `/api/system/getConf`.

**Next Step:** Run `check_docs.js` to identify the next missing API and continue documentation. 

---
## 2025-05-11 16:17 - Ran `check_docs.js` script

**Timestamp before script:** 2025-05-11 16:17:18
**Timestamp after script:** 2025-05-11 16:17:38

**Execution:**
- Command: `node check_docs.js`
- Working directory: `D:\siyuan\siyuan-kernelApi-docs\scripts`

**Result:**
- API definitions: 407 (No change)
- Missing API docs: 53 (Down from 54)
- Orphaned docs: 1 (`transactions\transactions.html` - still present)

**Full output:**
```
PS D:\siyuan\siyuan-kernelApi-docs\scripts> node check_docs.js

üîÑ Ê≠£Âú®Â∞ùËØïÊõ¥Êñ∞Êú¨Âú∞ÊÄùÊ∫ê‰ªìÂ∫ì: D:\siyuan\siyuan
   ÂàáÊç¢Âà∞ÁõÆÂΩï: D:\siyuan\siyuan
‚úÖ Êú¨Âú∞ÊÄùÊ∫ê‰ªìÂ∫ìÊõ¥Êñ∞ÊàêÂäü:
   (Êó†Êõ¥Êñ∞ÂÜÖÂÆπ)

üöÄ ÂºÄÂßãÂèåÈáçÊ†°È™å API ÊñáÊ°£Ë¶ÜÁõñÊÉÖÂÜµ...

üìÇ ÂºÄÂßãÊ£ÄÊü• API Êñá‰ª∂ÁªìÊûÑ (‰∏ÄÂØπ‰∏ÄÂåπÈÖç)...
   Êâ´Êèè‰∫Ü 49 ‰∏™Áâ©ÁêÜÂ≠êÁõÆÂΩï‰∏≠ÁöÑ 354 ‰∏™ÈùûÁ¥¢Âºï HTML Êñá‰ª∂.
   üö® Êñá‰ª∂ÁªìÊûÑÊ£ÄÊü•ÔºöÂèëÁé∞ 53 ‰∏™ API Áº∫Â∞ëÂØπÂ∫îÁöÑÊñáÊ°£Êñá‰ª∂:
     - /api/setting/setKeymap
     - /api/setting/setPublish
     // ... (list of 53 missing APIs) ...
     - /api/ui/reloadUI
   ‚ö†Ô∏è Êñá‰ª∂ÁªìÊûÑÊ£ÄÊü•ÔºöÂèëÁé∞ 1 ‰∏™Â≠§Á´ãÁöÑÊñáÊ°£Êñá‰ª∂ (‰ª£Á†Å‰∏≠Êó†ÂØπÂ∫î API ÂÆö‰πâ):
     - transactions\transactions.html (Â∞ùËØïÂåπÈÖç: /api/transactions/transactions Êàñ /ws/transactions/transactions)

üìÑ ÂºÄÂßãÊ£ÄÊü•ÂàÜÁªÑÁ¥¢ÂºïÊñá‰ª∂ (index.html)...
   --- ÂØπÊØî‰ª£Á†ÅÂÆö‰πâ‰∏éÁ¥¢ÂºïÊñá‰ª∂ ---
   // ... (consistent index checks omitted for brevity) ...
   ‚úÖ ÊâÄÊúâÂàÜÁªÑÁ¥¢ÂºïÂùá‰∏é‰ª£Á†ÅÂÆö‰πâ‰∏ÄËá¥Ôºå‰∏îÊó†Â≠§Á´ãÁ¥¢Âºï„ÄÇ

üèÅ ÂèåÈáçÊ†°È™åÂÆåÊàê„ÄÇÊÄªÁªìÔºö
   - üî¥ 53 ‰∏™ API Áº∫Â∞ëÂØπÂ∫îÁöÑÊñáÊ°£Êñá‰ª∂„ÄÇ
   - üü° 1 ‰∏™Â≠§Á´ãÁöÑÊñáÊ°£Êñá‰ª∂ÈúÄË¶ÅÊ∏ÖÁêÜ„ÄÇ
   - ‚úÖ Ê≤°ÊúâÂèëÁé∞Â≠§Á´ãÁöÑ index.html Êñá‰ª∂„ÄÇ
   ËØ∑Ê†πÊçÆ‰∏äÈù¢ÁöÑËØ¶ÁªÜÊä•ÂëäËøõË°åÂ§ÑÁêÜ„ÄÇ
PS D:\siyuan\siyuan-kernelApi-docs\scripts>
```

**Next Step:** Process the next missing API: `/api/setting/setKeymap`. 

---
## 2025-05-11 16:59 - APIÊñáÊ°£: `/api/setting/setKeymap`

**Êó∂Èó¥Êà≥:**
- ÂºÄÂßã: 2025-05-11 16:35:35 (Â§ßÁ∫¶)
- ÁªìÊùü: 2025-05-11 16:59:35

**Â§ÑÁêÜÁöÑAPI:** `/api/setting/setKeymap`

**ÊëòË¶Å:** ‰∏∫ `/api/setting/setKeymap` API Á´ØÁÇπÂàõÂª∫‰∫Ü HTML ÊñáÊ°£„ÄÇ

**ËØ¶ÊÉÖ:**
*   **API Á´ØÁÇπ:** `/api/setting/setKeymap`
*   **HTTP ÊñπÊ≥ï:** `POST`
*   **ËÆ§ËØÅ:** `model.CheckAuth`, `model.CheckAdminRole`, `model.CheckReadonly`„ÄÇ
*   **Go ÂáΩÊï∞:** `setKeymap` (‰Ωç‰∫é `siyuan/kernel/api/setting.go` Êñá‰ª∂ÔºåÁ¨¨ 485-504 Ë°å)„ÄÇ
*   **ËØ∑Ê±Ç‰ΩìÁªìÊûÑ:** ËØ∑Ê±Ç‰ΩìÊòØ‰∏Ä‰∏™ JSON ÂØπË±°ÔºåÂåÖÂê´‰∏Ä‰∏™ `data` Â≠óÊÆµ„ÄÇËøô‰∏™ `data` Â≠óÊÆµÊåÅÊúâ‰∏Ä‰∏™ `map[string]interface{}`Ôºå‰ª£Ë°®Êï¥‰∏™Âø´Êç∑ÈîÆÈÖçÁΩÆ„ÄÇËøô‰∏™ map ÁöÑÈîÆÈÄöÂ∏∏ÊòØÂàÜÁ±ª (‰æãÂ¶Ç: `"general"`, `"editor"`)ÔºåÂÄºÊòØÂëΩ‰ª§Âà∞Âø´Êç∑ÈîÆÁöÑÂµåÂ•óÊò†Â∞Ñ (‰æãÂ¶Ç: `"riffCard": "‚åòF1"`)„ÄÇ
    *   `conf.Keymap` Âú® `siyuan/kernel/conf/layout.go` ‰∏≠ÂÆö‰πâ‰∏∫ `type Keymap map[string]interface{}`„ÄÇ
*   **ÂäüËÉΩ:** Êõ¥Êñ∞ÊÄùÊ∫êÁ¨îËÆ∞ÁöÑÂÖ®Â±ÄÂø´Êç∑ÈîÆÈÖçÁΩÆ„ÄÇ
*   **ÂìçÂ∫î:** Ê†áÂáÜÁöÑÊÄùÊ∫ê API ÂìçÂ∫îÁªìÊûÑ (`{code, msg, data}`), ÊàêÂäüÊó∂ `data` ‰∏∫ `null`„ÄÇ
*   **Êìç‰Ωú:** ÂàõÂª∫‰∫Ü `siyuan-kernelApi-docs/setting/setKeymap.html`.
    *   ÊñáÊ°£‰∏≠ÂåÖÂê´‰∫ÜËØ∑Ê±Ç‰ΩìÁªìÊûÑÁöÑÊèèËø∞„ÄÅ‰∏Ä‰∏™Á§∫‰æã‰ª•Âèä‰∏Ä‰∏™Âú®Á∫øÊµãËØïÂå∫ÂüüÔºåËØ•Âå∫ÂüüÊúâ‰∏Ä‰∏™ÊåâÈíÆÂèØ‰ª•ÈÄöËøá `/api/system/getConf` Âä†ËΩΩÂΩìÂâçÁöÑÂø´Êç∑ÈîÆËÆæÁΩÆ„ÄÇ
    *   Âú®ÁîüÊàêÁöÑ HTML ‰∏≠ÈÅáÂà∞‰∫Ü‰∏é JavaScript Ê®°ÊùøÂ≠óÁ¨¶‰∏≤Áõ∏ÂÖ≥ÁöÑÊåÅÁª≠ÊÄß linter ÈîôËØØ„ÄÇÂ∞ùËØï‰ΩøÁî® `edit_file` Â∑•ÂÖ∑ËøõË°åÂ§öÊ¨°‰øÆÂ§çÔºå‰ΩÜÂ∫îÁî®Ê®°ÂûãÊú™ËÉΩÊ≠£Á°ÆÊâßË°åÊõ¥Êîπ„ÄÇÂÜ≥ÂÆöÂú®‰∏çËß£ÂÜ≥Ëøô‰∫õÊ¨°Ë¶Å JS linting ÈóÆÈ¢òÁöÑÊÉÖÂÜµ‰∏ãÁªßÁª≠„ÄÇ

**‰∏ã‰∏ÄÊ≠•:** ËøêË°å `check_docs.js` ‰ª•Á°ÆÂÆö‰∏ã‰∏Ä‰∏™Áº∫Â§±ÁöÑ API Âπ∂ÁªßÁª≠ÊñáÊ°£ÂåñÂ∑•‰Ωú„ÄÇ

---
## 2025-05-11 17:13 - APIÊñáÊ°£: `/api/setting/setPublish`

**Êó∂Èó¥Êà≥:**
- ÂºÄÂßã: 2025-05-11 17:11:04 (Â§ßÁ∫¶)
- ÁªìÊùü: 2025-05-11 17:13:12

**Â§ÑÁêÜÁöÑAPI:** `/api/setting/setPublish`

**ÊëòË¶Å:** ‰∏∫ `/api/setting/setPublish` API Á´ØÁÇπÂàõÂª∫‰∫Ü HTML ÊñáÊ°£„ÄÇ

**ËØ¶ÊÉÖ:**
*   **API Á´ØÁÇπ:** `/api/setting/setPublish`
*   **HTTP ÊñπÊ≥ï:** `POST`
*   **ËÆ§ËØÅ:** `model.CheckAuth`, `model.CheckAdminRole`, `model.CheckReadonly`„ÄÇ
*   **Go ÂáΩÊï∞:** `setPublish` (‰Ωç‰∫é `siyuan/kernel/api/setting.go` Êñá‰ª∂ÔºåÁ¨¨ 539-567 Ë°å)„ÄÇ
*   **ËØ∑Ê±Ç‰ΩìÁªìÊûÑ:** Êé•Âèó‰∏Ä‰∏™ÂÆåÊï¥ÁöÑ `conf.Publish` ÂØπË±°ÔºåÂÆö‰πâÂú® `siyuan/kernel/conf/publish.go`„ÄÇ
    *   `Enable` (boolean): ÂêØÁî®/Á¶ÅÁî®ÂèëÂ∏ÉÊúçÂä°„ÄÇ
    *   `Port` (uint16): ÂèëÂ∏ÉÊúçÂä°‰ΩøÁî®ÁöÑÁ´ØÂè£„ÄÇ
    *   `Auth` (object): Basic ËÆ§ËØÅËÆæÁΩÆ„ÄÇ
        *   `Enable` (boolean): ÂêØÁî®/Á¶ÅÁî®ÂèëÂ∏ÉÊúçÂä°ÁöÑ Basic ËÆ§ËØÅ„ÄÇ
        *   `Accounts` (array of objects): Basic ËÆ§ËØÅÁöÑÁî®Êà∑Âêç/ÂØÜÁ†Å/Â§áÊ≥®ÂàóË°®„ÄÇ
*   **ÂäüËÉΩ:** Êõ¥Êñ∞ÂÖ®Â±ÄÂèëÂ∏ÉÊúçÂä°ÈÖçÁΩÆ„ÄÇÂ¶ÇÊûú `enable` ‰∏∫ trueÔºåÂÆÉ‰ºöÂ∞ùËØïÂú®ÊåáÂÆöÁöÑ `port` ‰∏äÂàùÂßãÂåñ/ÈáçÂêØÂèëÂ∏ÉÊúçÂä°„ÄÇ
*   **ÂìçÂ∫î:** Ê†áÂáÜÁöÑÊÄùÊ∫ê API ÂìçÂ∫î„ÄÇÊàêÂäüÊó∂ (`code: 0`)Ôºå`data` ÂåÖÂê´:
    *   `port` (number): ÂèëÂ∏ÉÊúçÂä°ÂÆûÈôÖËøêË°åÁöÑÁ´ØÂè£Âè∑„ÄÇ
    *   `publish` (object): Êõ¥Êñ∞ÂêéÁöÑÂÆåÊï¥ `conf.Publish` ÂØπË±°„ÄÇ
*   **Êìç‰Ωú:** ÂàõÂª∫‰∫Ü `siyuan-kernelApi-docs/setting/setPublish.html`.
    *   ÊñáÊ°£ÂåÖÊã¨ `conf.Publish`, `conf.BasicAuth`, Âíå `conf.BasicAuthAccount` ÁöÑËØ¶ÁªÜÂèÇÊï∞Ë°®„ÄÇ
    *   Âú®Á∫øÊµãËØïÂå∫ÂüüÂåÖÂê´‰∏Ä‰∏™ `loadCurrentPublishConf()` ÊåâÈíÆÔºåËØ•ÊåâÈíÆÈ¶ñÂÖàÂ∞ùËØïÈÄöËøá `/api/setting/getPublish` Ëé∑ÂèñÂΩìÂâçËÆæÁΩÆÔºåÂ¶ÇÊûúÈúÄË¶ÅÂàôÂõûÈÄÄÂà∞ `/api/system/getConf`„ÄÇ

**‰∏ã‰∏ÄÊ≠•:** ËøêË°å `check_docs.js` ‰ª•Á°ÆÂÆö‰∏ã‰∏Ä‰∏™Áº∫Â§±ÁöÑ API Âπ∂ÁªßÁª≠ÊñáÊ°£ÂåñÂ∑•‰Ωú„ÄÇ 

---
## 2025-05-11 17:18 - APIÊñáÊ°£: `/api/setting/setSearch`

**Êó∂Èó¥Êà≥:**
- ÂºÄÂßã: 2025-05-11 17:17:39 (Â§ßÁ∫¶)
- ÁªìÊùü: 2025-05-11 17:18:57

**Â§ÑÁêÜÁöÑAPI:** `/api/setting/setSearch`

**ÊëòË¶Å:** ‰∏∫ `/api/setting/setSearch` API Á´ØÁÇπÂàõÂª∫‰∫Ü HTML ÊñáÊ°£„ÄÇ

**ËØ¶ÊÉÖ:**
*   **API Á´ØÁÇπ:** `/api/setting/setSearch`
*   **HTTP ÊñπÊ≥ï:** `POST`
*   **ËÆ§ËØÅ:** `model.CheckAuth`, `model.CheckAdminRole`, `model.CheckReadonly`„ÄÇ
*   **Go ÂáΩÊï∞:** `setSearch` (‰Ωç‰∫é `siyuan/kernel/api/setting.go` Êñá‰ª∂ÔºåÁ¨¨ 422-457 Ë°å)„ÄÇ
*   **ËØ∑Ê±Ç‰ΩìÁªìÊûÑ:** Êé•Âèó‰∏Ä‰∏™ÂÆåÊï¥ÁöÑ `conf.Search` ÂØπË±°ÔºåÂÆö‰πâÂú® `siyuan/kernel/conf/search.go`„ÄÇ
    *   ÂåÖÂê´‰ºóÂ§öÂ∏ÉÂ∞îÂûãÂ≠óÊÆµÊéßÂà∂ÊêúÁ¥¢ÂÜÖÂÆπÁ±ªÂûã (Â¶Ç `document`, `heading`, `codeBlock` Á≠â)„ÄÇ
    *   ÂåÖÂê´ÈÄöÁî®ËÆæÁΩÆÂ¶Ç `limit` (ÊúÄÂ∞è32), `caseSensitive`„ÄÇ
    *   ÂåÖÂê´ËåÉÂõ¥ËÆæÁΩÆÂ¶Ç `name`, `alias`, `memo`, `ial`„ÄÇ
    *   ÂåÖÂê´ËµÑÊ∫êÊñá‰ª∂Á¥¢ÂºïËÆæÁΩÆ `indexAssetPath`„ÄÇ
    *   ÂåÖÂê´ÂèçÈìæÊèêÂèäÂíåËôöÊãüÂºïÁî®Áõ∏ÂÖ≥ÈÖçÁΩÆ (`backlinkMention*`, `virtualRef*`)„ÄÇ
*   **ÂäüËÉΩ:** Êõ¥Êñ∞ÂÖ®Â±ÄÊêúÁ¥¢ÈÖçÁΩÆ„ÄÇ
    *   Êõ¥Êîπ `caseSensitive` Êàñ `indexAssetPath` ‰ºöËß¶ÂèëÂÖ®ÈáèÈáçÂª∫Á¥¢Âºï„ÄÇ
    *   Êõ¥ÊîπËôöÊãüÂºïÁî®Áõ∏ÂÖ≥ÈÖçÁΩÆ‰ºöÈáçÁΩÆËôöÊãüÂºïÁî®ÁºìÂ≠ò„ÄÇ
*   **ÂìçÂ∫î:** Ê†áÂáÜÁöÑÊÄùÊ∫ê API ÂìçÂ∫î„ÄÇÊàêÂäüÊó∂ (`code: 0`)Ôºå`data` ÂåÖÂê´Êõ¥Êñ∞ÂêéÁöÑ `conf.Search` ÂØπË±°„ÄÇ
*   **Êìç‰Ωú:** ÂàõÂª∫‰∫Ü `siyuan-kernelApi-docs/setting/setSearch.html`.
    *   ÊñáÊ°£‰∏≠ËØ¶ÁªÜÂàóÂá∫‰∫Ü `conf.Search` ÁöÑÊâÄÊúâÂ≠óÊÆµÂèäÂÖ∂ÈªòËÆ§ÂÄº„ÄÇ
    *   Âú®Á∫øÊµãËØïÂå∫Êèê‰æõ‰∫ÜÂä†ËΩΩÂΩìÂâçÊêúÁ¥¢ÈÖçÁΩÆÁöÑÂäüËÉΩ„ÄÇ

**‰∏ã‰∏ÄÊ≠•:** ËøêË°å `check_docs.js` ‰ª•Á°ÆÂÆö‰∏ã‰∏Ä‰∏™Áº∫Â§±ÁöÑ API Âπ∂ÁªßÁª≠ÊñáÊ°£ÂåñÂ∑•‰Ωú„ÄÇ 

---
## 2025-05-11 17:22 - APIÊñáÊ°£: `/api/setting/setSnippet` (ÂÖ®Â±ÄÂºÄÂÖ≥)

**Êó∂Èó¥Êà≥:**
- ÂºÄÂßã: 2025-05-11 17:21:10 (Â§ßÁ∫¶)
- ÁªìÊùü: 2025-05-11 17:22:28

**Â§ÑÁêÜÁöÑAPI:** `/api/setting/setSnippet`

**ÊëòË¶Å:** ‰∏∫ `/api/setting/setSnippet` API Á´ØÁÇπÂàõÂª∫‰∫Ü HTML ÊñáÊ°£ÔºåËØ•Êé•Âè£Áî®‰∫éÊéßÂà∂‰ª£Á†ÅÁâáÊÆµÁöÑÂÖ®Â±ÄÂêØÁî®Áä∂ÊÄÅ„ÄÇ

**ËØ¶ÊÉÖ:**
*   **API Á´ØÁÇπ:** `/api/setting/setSnippet` (ÂÆûÈôÖË∞ÉÁî®ÂÜÖÊ†∏‰∏≠ÁöÑ `setConfSnippet`)
*   **HTTP ÊñπÊ≥ï:** `POST`
*   **ËÆ§ËØÅ:** `model.CheckAuth`, `model.CheckAdminRole`, `model.CheckReadonly`„ÄÇ
*   **Go ÂáΩÊï∞:** `setConfSnippet` (‰Ωç‰∫é `siyuan/kernel/api/setting.go` Êñá‰ª∂ÔºåÁ¨¨ 53-76 Ë°å)„ÄÇ
*   **ËØ∑Ê±Ç‰ΩìÁªìÊûÑ:** Êé•Âèó‰∏Ä‰∏™ `conf.Snpt` ÂØπË±°ÔºåÂÆö‰πâÂú® `siyuan/kernel/conf/snippet.go`„ÄÇ
    *   `enabledCSS` (boolean): ÂÖ®Â±ÄÂêØÁî®/Á¶ÅÁî®ÊâÄÊúâ CSS ‰ª£Á†ÅÁâáÊÆµ (ÈªòËÆ§: `true`)„ÄÇ
    *   `enabledJS` (boolean): ÂÖ®Â±ÄÂêØÁî®/Á¶ÅÁî®ÊâÄÊúâ JS ‰ª£Á†ÅÁâáÊÆµ (ÈªòËÆ§: `true`)„ÄÇ
*   **ÂäüËÉΩ:** Êõ¥Êñ∞ÂÖ®Â±Ä‰ª£Á†ÅÁâáÊÆµÁöÑÂêØÁî®/Á¶ÅÁî®Áä∂ÊÄÅ„ÄÇ‰øÆÊîπ `conf.json` ‰∏≠ÁöÑ `snippet` ÈÉ®ÂàÜ„ÄÇ
*   **ÂìçÂ∫î:** Ê†áÂáÜÁöÑÊÄùÊ∫ê API ÂìçÂ∫î„ÄÇÊàêÂäüÊó∂ (`code: 0`)Ôºå`data` ÂåÖÂê´Êõ¥Êñ∞ÂêéÁöÑ `conf.Snpt` ÂØπË±°„ÄÇ
*   **Êìç‰Ωú:** ÂàõÂª∫‰∫Ü `siyuan-kernelApi-docs/setting/setSnippet.html`.
    *   ÊñáÊ°£‰∏≠ËØ¥Êòé‰∫ÜÊ≠§Êé•Âè£ÊòØÂÖ®Â±ÄÂºÄÂÖ≥ÔºåÂπ∂ÊåáÊòéÂçï‰∏™‰ª£Á†ÅÁâáÊÆµÁöÑÁÆ°ÁêÜÁî± `/api/snippet/*` ‰∏ãÁöÑÊé•Âè£Ë¥üË¥£„ÄÇ
    *   Âú®Á∫øÊµãËØïÂå∫ÂÖÅËÆ∏Áî®Êà∑ÂàáÊç¢ CSS Âíå JS ÁöÑÂÖ®Â±ÄÂêØÁî®Áä∂ÊÄÅ„ÄÇ

**Ê≥®ÊÑèÁÇπ:**
*   ‰∏é `/api/snippet/setSnippet` (‰Ωç‰∫é `siyuan/kernel/api/snippet.go`) ‰∏çÂêåÔºåÂêéËÄÖÁî®‰∫éÁÆ°ÁêÜ‰∏Ä‰∏™ `conf.Snippet` ÂØπË±°ÂàóË°®ÔºàÂç≥ÂÖ∑‰ΩìÁöÑ‰ª£Á†ÅÁâáÊÆµÂÜÖÂÆπÔºâ„ÄÇ

**‰∏ã‰∏ÄÊ≠•:** ËøêË°å `check_docs.js` ‰ª•Á°ÆÂÆö‰∏ã‰∏Ä‰∏™Áº∫Â§±ÁöÑ API Âπ∂ÁªßÁª≠ÊñáÊ°£ÂåñÂ∑•‰Ωú„ÄÇ 

---
## 2025-05-11 17:25 - API Doc: `/api/storage/getCriteria`

**Timestamps:**
- Start: 2025-05-11 17:23:49
- End: 2025-05-11 17:25:12

**API Processed:** `/api/storage/getCriteria`

**Summary:** Created HTML documentation for the `/api/storage/getCriteria` API endpoint.

**Details:**
*   **API Endpoint:** `/api/storage/getCriteria`
*   **HTTP Method:** `POST`
*   **Authentication:** `model.CheckAuth`.
*   **Go Function:** `getCriteria` in `siyuan/kernel/api/storage.go` (handler), which calls `model.GetCriteria()` in `siyuan/kernel/model/storage.go`.
*   **Associated Config Struct:** `model.Criterion`, `model.CriterionTypes`, `model.CriterionReplaceTypes` in `siyuan/kernel/model/storage.go`.
*   **Request Parameters:** None (empty JSON object `{}`).
*   **Functionality:** Retrieves a list of all saved search/replace criteria. These criteria are stored in `data/storage/criteria.json`.
*   **Response:** A JSON array of `Criterion` objects.
    *   Each `Criterion` object includes fields like `name`, `sort`, `group`, `hasReplace`, `method`, `hPath`, `idPath`, `k` (keyword), `r` (replacement), `types` (for search), and `replaceTypes` (for replacement).
*   **Action:** Created `siyuan-kernelApi-docs/storage/getCriteria.html`.
    *   The documentation includes detailed descriptions of the `Criterion`, `CriterionTypes`, and `CriterionReplaceTypes` structures.
    *   An online test area is provided.

**Next Step:** Run `check_docs.js` to identify the next missing API and continue documentation. 

---
## 2025-05-11 18:28 - API Doc: `/api/storage/getRecentDocs`

**Timestamps:**
- Start: 2025-05-11 18:27:44
- End: 2025-05-11 18:28:37

**API Processed:** `/api/storage/getRecentDocs`

**Summary:** Created HTML documentation for the `/api/storage/getRecentDocs` API endpoint.

**Details:**
*   **API Endpoint:** `/api/storage/getRecentDocs`
*   **HTTP Method:** `POST`
*   **Authentication:** `model.CheckAuth`.
*   **Go Function:** `getRecentDocs` in `siyuan/kernel/api/storage.go` (handler), which calls `model.GetRecentDocs()` in `siyuan/kernel/model/storage.go`.
*   **Associated Data Struct:** `model.RecentDoc` in `siyuan/kernel/model/storage.go`.
*   **Request Parameters:** None (empty JSON object `{}`).
*   **Functionality:** Retrieves a list of recently opened/edited documents. 
    *   Data is read from `data/storage/recent-doc.json`.
    *   The list is capped at 32 entries.
    *   Document titles are updated to the latest before returning.
    *   Non-existent documents are removed from the list.
*   **Response:** A JSON array of `RecentDoc` objects, each containing `rootID`, `icon`, and `title`.
*   **Action:** Created `siyuan-kernelApi-docs/storage/getRecentDocs.html`.
    *   The documentation includes a description of the `RecentDoc` structure and an example response.
    *   An online test area is provided.

**Next Step:** Run `check_docs.js` to identify the next missing API and continue documentation. 

---
## 2025-05-11 18:30 - API Doc: `/api/storage/removeCriterion`

**Timestamps:**
- Start: 2025-05-11 18:29:24
- End: 2025-05-11 18:30:50

**API Processed:** `/api/storage/removeCriterion`

**Summary:** Created HTML documentation for the `/api/storage/removeCriterion` API endpoint.

**Details:**
*   **API Endpoint:** `/api/storage/removeCriterion`
*   **HTTP Method:** `POST`
*   **Authentication:** `model.CheckAuth`, `model.CheckAdminRole`, `model.CheckReadonly`.
*   **Go Function:** `removeCriterion` in `siyuan/kernel/api/storage.go` (handler), which calls `model.RemoveCriterion(name)` in `siyuan/kernel/model/storage.go`.
*   **Request Parameters (JSON Body):** 
    *   `name` (string, required): The name of the criterion to remove.
*   **Functionality:** Removes a saved search/replace criterion by its name from `data/storage/criteria.json`.
*   **Response:** Standard API response (`{code, msg, data: null}`).
*   **Action:** Created `siyuan-kernelApi-docs/storage/removeCriterion.html`.
    *   The documentation includes request and response formats, examples, and an online test form.
    *   A tip to use `/api/storage/getCriteria` to find existing criterion names was added.

**Next Step:** Run `check_docs.js` to identify the next missing API. 

---
## 2025-05-11 18:34 - API Doc: `/api/storage/removeLocalStorageVals`

**Timestamps:**
- Start: 2025-05-11 18:31:33
- End: 2025-05-11 18:34:35

**API Processed:** `/api/storage/removeLocalStorageVals`

**Summary:** Created HTML documentation for the `/api/storage/removeLocalStorageVals` API endpoint.

**Details:**
*   **API Endpoint:** `/api/storage/removeLocalStorageVals`
*   **HTTP Method:** `POST`
*   **Authentication:** `model.CheckAuth`, `model.CheckAdminRole`, `model.CheckReadonly`.
*   **Go Function:** `removeLocalStorageVals` in `siyuan/kernel/api/storage.go` (handler), which calls `model.RemoveLocalStorageVals(keys)` in `siyuan/kernel/model/storage.go`.
*   **Request Parameters (JSON Body):** 
    *   `keys` (string[], required): An array of key names to remove from localStorage.
    *   `app` (string, required): The ID of the requesting application, used for event broadcasting.
*   **Functionality:** Removes multiple key-value pairs from the internal localStorage (stored in `data/storage/local-storage.json`). Broadcasts an event upon successful deletion.
*   **Response:** Standard API response (`{code, msg, data: null}`).
*   **Action:** Created `siyuan-kernelApi-docs/storage/removeLocalStorageVals.html`.
    *   The documentation includes request/response formats, examples, and an online test form.
    *   Added a note about the `app` parameter's role in event broadcasting.

**Next Step:** Run `check_docs.js` to identify the next missing API. 

---
## 2025-05-11 18:37 - API Doc: `/api/storage/setCriterion`

**Timestamps:**
- Start: 2025-05-11 18:35:18
- End: 2025-05-11 18:37:15

**API Processed:** `/api/storage/setCriterion`

**Summary:** Created HTML documentation for the `/api/storage/setCriterion` API endpoint.

**Details:**
*   **API Endpoint:** `/api/storage/setCriterion`
*   **HTTP Method:** `POST`
*   **Authentication:** `model.CheckAuth`, `model.CheckAdminRole`, `model.CheckReadonly`.
*   **Go Function:** `setCriterion` in `siyuan/kernel/api/storage.go` (handler), which calls `model.SetCriterion(criterion)` in `siyuan/kernel/model/storage.go`.
*   **Request Parameters (JSON Body):** 
    *   `criterion` (object, required): A complete `model.Criterion` object.
        *   `criterion.name` (string, required): Name of the criterion. Cannot be empty.
        *   Other fields include `sort`, `group`, `hasReplace`, `method`, `hPath`, `idPath`, `k`, `r`, `types`, `replaceTypes`.
*   **Functionality:** Creates a new search/replace criterion or updates an existing one if a criterion with the same `name` already exists. Data is stored in `data/storage/criteria.json`.
*   **Response:** Standard API response (`{code, msg, data: null}`).
*   **Action:** Created `siyuan-kernelApi-docs/storage/setCriterion.html`.
    *   The documentation includes a detailed description of the `Criterion` object, request/response formats, examples, and an online test form with a sample data loader.
    *   Linked to `/api/storage/getCriteria` for `CriterionTypes` and `CriterionReplaceTypes` definitions.

**Next Step:** Run `check_docs.js` to identify the next missing API. 

---
## 2025-05-11 18:38 - API Doc: `/api/storage/setLocalStorageVal`

**Timestamps:**
- Start: 2025-05-11 18:38:04
- End: 2025-05-11 18:38:56

**API Processed:** `/api/storage/setLocalStorageVal`

**Summary:** Created HTML documentation for the `/api/storage/setLocalStorageVal` API endpoint.

**Details:**
*   **API Endpoint:** `/api/storage/setLocalStorageVal`
*   **HTTP Method:** `POST`
*   **Authentication:** `model.CheckAuth`, `model.CheckAdminRole`, `model.CheckReadonly`.
*   **Go Function:** `setLocalStorageVal` in `siyuan/kernel/api/storage.go` (handler), which calls `model.SetLocalStorageVal(key, val)` in `siyuan/kernel/model/storage.go`.
*   **Request Parameters (JSON Body):** 
    *   `key` (string, required): The key name for the localStorage item.
    *   `val` (any, required): The value to set for the key (can be any JSON-compatible type).
    *   `app` (string, required): The ID of the requesting application, used for event broadcasting.
*   **Functionality:** Sets or updates a key-value pair in the internal localStorage (stored in `data/storage/local-storage.json`). Broadcasts an event to other clients upon success.
*   **Response:** Standard API response (`{code, msg, data: null}`).
*   **Action:** Created `siyuan-kernelApi-docs/storage/setLocalStorageVal.html`.
    *   The documentation includes request/response formats, examples for string and object values, and an online test form.
    *   Highlighted the `app` parameter's role in event broadcasting.

**Next Step:** Run `check_docs.js` to identify the next missing API. 