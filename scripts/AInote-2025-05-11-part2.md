# Ëøô‰∏™Âå∫ÊÆµÁî±ÂºÄÂèëËÄÖÁºñÂÜô,Êú™ÁªèÂÖÅËÆ∏Á¶ÅÊ≠¢AI‰øÆÊîπ

## 2025-05-11 14:01 - Ran `check_docs.js` script

*   **Time of execution**: 2025-05-11 14:01:50 - (refer to terminal output for end time)
*   **Script**: `node check_docs.js` (from `siyuan-kernelApi-docs/scripts`)
*   **Key Findings**:
    *   Found 407 API definitions in `router.go`.
    *   **69 APIs are missing documentation files** (down from 70).
    *   1 orphaned file still exists: `transactions/transactions.html`.
    *   All group `index.html` files are consistent with API definitions.
*   **Next API to document** (based on the new list): `/api/setting/addVirtualBlockRefExclude`.

---

## 2025-05-11 14:14

- **‰∏∫ `/api/setting/addVirtualBlockRefExclude` ÂàõÂª∫ÊñáÊ°£**:
    - ÈòÖËØª `siyuan/kernel/api/setting.go` ‰∏≠ `addVirtualBlockRefExclude` ÂáΩÊï∞ÁöÑÊ∫êÁ†Å (Á¨¨ 68 Ë°å)„ÄÇ
    - ÈòÖËØª `siyuan/kernel/api/router.go` ‰∏≠ËØ• API ÁöÑË∑ØÁî±ÂÆö‰πâ (Á¨¨ 353 Ë°å)„ÄÇ
    - **Á°ÆËÆ§‰ø°ÊÅØ**:
        - HTTP Method: `POST`.
        - Êé•Âè£Ë∑ØÂæÑ: `/api/setting/addVirtualBlockRefExclude`.
        - ËÆ§ËØÅÁä∂ÊÄÅ: "ÈúÄË¶ÅËÆ§ËØÅ" (`model.CheckAuth`), "ÈúÄË¶ÅÁÆ°ÁêÜÂëò" (`model.CheckAdminRole`), "Ê£ÄÊü•Âè™ËØªÊ®°Âºè" (`model.CheckReadonly`).
        - Êé•Âè£ÊèèËø∞: "Ê∑ªÂä†‰∏ÄÊâπÂÖ≥ÈîÆËØçÂà∞ËôöÊãüÂùóÂºïÁî®ÁöÑÊéíÈô§ÂàóË°®‰∏≠„ÄÇÁî®‰∫é‰ºòÂåñËôöÊãüÂºïÁî®ÁöÑÁõ∏ÂÖ≥ÊÄß„ÄÇÊàêÂäüÂêéÂπøÊí≠ setConf ‰∫ã‰ª∂„ÄÇÂú®Âè™ËØªÊ®°Âºè‰∏ãÁ¶ÅÊ≠¢„ÄÇ"
        - ËØ∑Ê±ÇÂèÇÊï∞ (JSON Body):
            - `keywords` (string[], ÂøÖÈúÄ) - Ë¶ÅÊ∑ªÂä†Âà∞ÊéíÈô§ÂàóË°®ÁöÑÂÖ≥ÈîÆËØçÊï∞ÁªÑ„ÄÇ
        - ËøîÂõûÂÄº (JSON): Ê†áÂáÜÁªìÊûÑ `code`, `msg`, `data` (ÊàêÂäüÊó∂ `data` ‰∏∫ `null`).
    - ÂàõÂª∫‰∫ÜÊñ∞ÁöÑÊñáÊ°£Êñá‰ª∂ `siyuan-kernelApi-docs/setting/addVirtualBlockRefExclude.html`ÔºåÂåÖÂê´Âú®Á∫øÊµãËØïÂå∫„ÄÇ
    - ÊñáÊ°£‰∏≠ÂåÖÂê´‰∫ÜÊé•Âè£ÊèèËø∞„ÄÅÂèÇÊï∞„ÄÅËøîÂõûÂÄºÂèäÁ§∫‰æã„ÄÇ
- **‰∏ã‰∏ÄÊ≠•**: ËøêË°å `check_docs.js` Á°ÆËÆ§‰∏ã‰∏Ä‰∏™Áº∫Â§±ÁöÑ API Âπ∂ÁªßÁª≠Â§ÑÁêÜ„ÄÇ

---

## 2025-05-11 14:32 - Refactored AInote.md

- Ê†πÊçÆÂì•Âì•ÁöÑÊåáÁ§∫ÔºåÂ∞Ü‰∏ª `AInote.md` Êñá‰ª∂ËøõË°å‰∫ÜÊãÜÂàÜ„ÄÇ
- **Êìç‰ΩúËØ¶ÊÉÖ**:
    - Â∞ÜÂéü `AInote.md` ‰∏≠ÁöÑÊó•ÂøóÊù°ÁõÆÊåâÊó•Êúü (`YYYY-MM-DD`) ÊãÜÂàÜÂà∞ÂçïÁã¨ÁöÑÊñá‰ª∂‰∏≠„ÄÇ
    - ÂàõÂª∫‰∫Ü‰ª•‰∏ãÊØèÊó•Êó•ÂøóÊñá‰ª∂:
        - `AInote-2025-05-10.md`
        - `AInote-2025-05-11.md` (This entry refers to the file before this current refactoring)
    - ÊØè‰∏™ÊØèÊó•Êó•ÂøóÊñá‰ª∂ÈÉΩ‰øùÁïô‰∫ÜÈ°∂ÈÉ®ÁöÑÂºÄÂèëËÄÖË¶ÅÊ±ÇÂå∫Âùó„ÄÇ
    - ‰∏ª `AInote.md` Êñá‰ª∂Â∑≤Êõ¥Êñ∞‰∏∫Á¥¢ÂºïÊñá‰ª∂ÔºåÂåÖÂê´ÊåáÂêëÂêÑ‰∏™ÊØèÊó•Êó•ÂøóÊñá‰ª∂ÁöÑÈìæÊé•„ÄÇ
- **ÂéüÂõ†**: ‰∏ª `AInote.md` Êñá‰ª∂ÂÜÖÂÆπËøáÈïøÔºàÁ∫¶600Ë°åÔºâÔºå‰∏çÊòìÁÆ°ÁêÜÂíåÊü•ÈòÖ„ÄÇ
- **ÂêéÁª≠**: ‰ªäÊó•ÂêéÁª≠Êó•ÂøóÂ∞ÜÁªßÁª≠ËÆ∞ÂΩïÂú®Êú¨Êñá‰ª∂ (`AInote-2025-05-11-part2.md`)„ÄÇ

---

**Timestamp:** 2025-05-11 16:03:32 GMT+0800

**Action:** Ran `check_docs.js` script.

**Summary of Findings:**
*   API definitions in `router.go`: 407
*   APIs missing documentation: 56
*   Orphaned documentation files: 1 (`transactions/transactions.html`)
*   Group `index.html` files: Consistent with API definitions.

**Next API to document:** `/api/setting/setExport` (based on the script output).

---

**Timestamp:** 2025-05-11 16:06:15 GMT+0800

**API Processed:** `/api/setting/setExport`

**Summary:** Created HTML documentation for the `/api/setting/setExport` API endpoint.

**Details:**
*   **API Endpoint:** `/api/setting/setExport`
*   **HTTP Method:** `POST`
*   **Authentication:** `model.CheckAuth`, `model.CheckAdminRole`, `model.CheckReadonly`.
*   **Go Function:** `setExport` in `siyuan/kernel/api/setting.go`.
*   **Associated Config Struct:** `conf.Export` in `siyuan/kernel/conf/export.go`.
*   **Request Parameters (JSON Body):** A complete `conf.Export` object. Key fields include:
    *   `paragraphBeginningSpace` (boolean)
    *   `addTitle` (boolean)
    *   `blockRefMode` (number)
    *   `blockEmbedMode` (number)
    *   `pandocBin` (string)
    *   `markdownYFM` (boolean)
    *   `pdfFooter` (string)
    *   (And others related to watermarks, templates, etc.)
*   **Functionality:** Updates the global export configurations. Validates `pandocBin` if provided.
*   **Response:** Standard structure, with `data` containing the updated `Export` object on success.
*   **Action:** Created `siyuan-kernelApi-docs/setting/setExport.html`.
    *   The documentation includes a detailed table of all parameters from `conf.Export`.
    *   An online test area is provided, with a helper button to load current export settings from `/api/system/getConf` to prepopulate the request body.
    *   Fixed linter errors related to JavaScript string formatting in the generated HTML.

**Next Step:** Run `check_docs.js` to identify the next missing API and continue documentation.

---
## 2025-05-11 16:12 - Ran `check_docs.js` script

**Timestamp before script:** 2025-05-11 16:12:28
**Timestamp after script:** 2025-05-11 16:12:40

**Execution:**
- Command: `node check_docs.js`
- Working directory: `D:\siyuan\siyuan-kernelApi-docs\scripts`

**Result:**
- API definitions: 407
- Missing API docs: 54
- Orphaned docs: 1 (`transactions/transactions.html` - this seems to be a persistent one, maybe we should check it later if it's not automatically handled by fixing missing docs or if it's a real orphan)

**Full output:**
```
PS D:\siyuan\siyuan-kernelApi-docs\scripts> node check_docs.js

üîÑ Ê≠£Âú®Â∞ùËØïÊõ¥Êñ∞Êú¨Âú∞ÊÄùÊ∫ê‰ªìÂ∫ì: D:\siyuan\siyuan
   ÂàáÊç¢Âà∞ÁõÆÂΩï: D:\siyuan\siyuan
‚úÖ Êú¨Âú∞ÊÄùÊ∫ê‰ªìÂ∫ìÊõ¥Êñ∞ÊàêÂäü:
   (Êó†Êõ¥Êñ∞ÂÜÖÂÆπ)

‚ÑπÔ∏è Â∞Ü‰ªéÊú¨Âú∞Ë∑ØÂæÑËØªÂèñ router.go: D:\siyuan\siyuan\kernel\api\router.go

üîç ‰ªé Êú¨Âú∞Êñá‰ª∂ router.go ‰∏≠ÊâæÂà∞ 407 ‰∏™ÊúâÊïà API/WS ÂÆö‰πâÔºåÂàÜÂ∏ÉÂú® 44 ‰∏™ÂàÜÁ±ª‰∏≠„ÄÇ

üöÄ ÂºÄÂßãÂèåÈáçÊ†°È™å API ÊñáÊ°£Ë¶ÜÁõñÊÉÖÂÜµ...

üìÇ ÂºÄÂßãÊ£ÄÊü• API Êñá‰ª∂ÁªìÊûÑ (‰∏ÄÂØπ‰∏ÄÂåπÈÖç)...
   Êâ´Êèè‰∫Ü 49 ‰∏™Áâ©ÁêÜÂ≠êÁõÆÂΩï‰∏≠ÁöÑ 353 ‰∏™ÈùûÁ¥¢Âºï HTML Êñá‰ª∂.
   üö® Êñá‰ª∂ÁªìÊûÑÊ£ÄÊü•ÔºöÂèëÁé∞ 54 ‰∏™ API Áº∫Â∞ëÂØπÂ∫îÁöÑÊñáÊ°£Êñá‰ª∂:
     - /api/setting/setFlashcard
     - /api/setting/setKeymap
     - /api/setting/setPublish
     - /api/setting/setSearch
     - /api/setting/setSnippet
     - /api/storage/getCriteria
     - /api/storage/getRecentDocs
     - /api/storage/removeCriterion
     - /api/storage/removeLocalStorageVals
     - /api/storage/setCriterion
     - /api/storage/setLocalStorageVal
     - /api/sync/createCloudSyncDir
     - /api/sync/exportSyncProviderS3
     - /api/sync/exportSyncProviderWebDAV
     - /api/sync/getBootSync
     - /api/sync/getSyncInfo
     - /api/sync/importSyncProviderS3
     - /api/sync/importSyncProviderWebDAV
     - /api/sync/listCloudSyncDir
     - /api/sync/performBootSync
     - /api/sync/performSync
     - /api/sync/removeCloudSyncDir
     - /api/sync/setCloudSyncDir
     - /api/sync/setSyncEnable
     - /api/sync/setSyncGenerateConflictDoc
     - /api/sync/setSyncInterval
     - /api/sync/setSyncMode
     - /api/sync/setSyncPerception
     - /api/sync/setSyncProvider
     - /api/sync/setSyncProviderLocal
     - /api/sync/setSyncProviderS3
     - /api/sync/setSyncProviderWebDAV
     - /api/system/addMicrosoftDefenderExclusion
     - /api/system/exportConf
     - /api/system/getCaptcha
     - /api/system/getChangelog
     - /api/system/getConf
     - /api/system/getEmojiConf
     - /api/system/getWorkspaceInfo
     - /api/system/getWorkspaces
     - /api/system/ignoreAddMicrosoftDefenderExclusion
     - /api/system/importConf
     - /api/system/loginAuth
     - /api/system/logoutAuth
     - /api/system/reloadUI
     - /api/system/setAPIToken
     - /api/system/setAccessAuthCode
     - /api/system/setDownloadInstallPkg
     - /api/system/uiproc
     - /api/ui/reloadAttributeView
     - /api/ui/reloadFiletree
   ‚úÖ Á¥¢ÂºïÊ£ÄÊü• [account]: index.html ÂÜÖÂÆπ‰∏é API ÂÆö‰πâ‰∏ÄËá¥ (5 ‰∏™)„ÄÇ
   ... (omitted consistent index checks for brevity) ...
   ‚úÖ ÊâÄÊúâÂàÜÁªÑÁ¥¢ÂºïÂùá‰∏é‰ª£Á†ÅÂÆö‰πâ‰∏ÄËá¥Ôºå‰∏îÊó†Â≠§Á´ãÁ¥¢Âºï„ÄÇ

üèÅ ÂèåÈáçÊ†°È™åÂÆåÊàê„ÄÇÊÄªÁªìÔºö
   - üî¥ 54 ‰∏™ API Áº∫Â∞ëÂØπÂ∫îÁöÑÊñáÊ°£Êñá‰ª∂„ÄÇ
   - üü° 1 ‰∏™Â≠§Á´ãÁöÑÊñáÊ°£Êñá‰ª∂ÈúÄË¶ÅÊ∏ÖÁêÜ„ÄÇ
   - ‚úÖ Ê≤°ÊúâÂèëÁé∞Â≠§Á´ãÁöÑ index.html Êñá‰ª∂„ÄÇ
   ËØ∑Ê†πÊçÆ‰∏äÈù¢ÁöÑËØ¶ÁªÜÊä•ÂëäËøõË°åÂ§ÑÁêÜ„ÄÇ
PS D:\siyuan\siyuan-kernelApi-docs\scripts>
```

**Next Step:** Process the next missing API: `/api/setting/setFlashcard`.

---
## 2025-05-11 16:15 - API Doc: `/api/setting/setFlashcard`

**Timestamps:**
- Start: 2025-05-11 16:14:09
- End: 2025-05-11 16:15:19

**API Processed:** `/api/setting/setFlashcard`

**Summary:** Created HTML documentation for the `/api/setting/setFlashcard` API endpoint.

**Details:**
*   **API Endpoint:** `/api/setting/setFlashcard`
*   **HTTP Method:** `POST`
*   **Authentication:** `model.CheckAuth`, `model.CheckAdminRole`, `model.CheckReadonly`.
*   **Go Function:** `setFlashcard` in `siyuan/kernel/api/setting.go` (Lines 225-250).
*   **Associated Config Struct:** `conf.Flashcard` in `siyuan/kernel/conf/flashcard.go`.
*   **Request Parameters (JSON Body):** A complete `conf.Flashcard` object. Key fields include:
    *   `newCardLimit` (number, default: 20) - Min 0.
    *   `reviewCardLimit` (number, default: 200) - Min 0.
    *   `mark` (boolean, default: true)
    *   `list` (boolean, default: true)
    *   `superBlock` (boolean, default: true)
    *   `heading` (boolean, default: true)
    *   `deck` (boolean, default: false)
    *   `reviewMode` (number, default: 0) - 0:Ê∑∑Âêà, 1:Êñ∞Âç°‰ºòÂÖà, 2:ÊóßÂç°‰ºòÂÖà.
    *   `requestRetention` (number, default: FSRS default)
    *   `maximumInterval` (number, default: FSRS default)
    *   `weights` (string, default: FSRS default) - Comma-separated floats.
*   **Functionality:** Updates the global flashcard configurations. Validates `newCardLimit` and `reviewCardLimit` to be non-negative.
*   **Response:** Standard structure, with `data` containing the updated `Flashcard` object on success.
*   **Action:** Created `siyuan-kernelApi-docs/setting/setFlashcard.html`.
    *   The documentation includes a detailed table of all parameters from `conf.Flashcard` along with their default values and descriptions.
    *   An online test area is provided, with a helper button to load current flashcard settings from `/api/system/getConf`.

**Next Step:** Run `check_docs.js` to identify the next missing API and continue documentation. 

---
## 2025-05-11 16:17 - Ran `check_docs.js` script

**Timestamp before script:** 2025-05-11 16:17:18
**Timestamp after script:** 2025-05-11 16:17:38

**Execution:**
- Command: `node check_docs.js`
- Working directory: `D:\siyuan\siyuan-kernelApi-docs\scripts`

**Result:**
- API definitions: 407 (No change)
- Missing API docs: 53 (Down from 54)
- Orphaned docs: 1 (`transactions\transactions.html` - still present)

**Full output:**
```
PS D:\siyuan\siyuan-kernelApi-docs\scripts> node check_docs.js

üîÑ Ê≠£Âú®Â∞ùËØïÊõ¥Êñ∞Êú¨Âú∞ÊÄùÊ∫ê‰ªìÂ∫ì: D:\siyuan\siyuan
   ÂàáÊç¢Âà∞ÁõÆÂΩï: D:\siyuan\siyuan
‚úÖ Êú¨Âú∞ÊÄùÊ∫ê‰ªìÂ∫ìÊõ¥Êñ∞ÊàêÂäü:
   (Êó†Êõ¥Êñ∞ÂÜÖÂÆπ)

üöÄ ÂºÄÂßãÂèåÈáçÊ†°È™å API ÊñáÊ°£Ë¶ÜÁõñÊÉÖÂÜµ...

üìÇ ÂºÄÂßãÊ£ÄÊü• API Êñá‰ª∂ÁªìÊûÑ (‰∏ÄÂØπ‰∏ÄÂåπÈÖç)...
   Êâ´Êèè‰∫Ü 49 ‰∏™Áâ©ÁêÜÂ≠êÁõÆÂΩï‰∏≠ÁöÑ 354 ‰∏™ÈùûÁ¥¢Âºï HTML Êñá‰ª∂.
   üö® Êñá‰ª∂ÁªìÊûÑÊ£ÄÊü•ÔºöÂèëÁé∞ 53 ‰∏™ API Áº∫Â∞ëÂØπÂ∫îÁöÑÊñáÊ°£Êñá‰ª∂:
     - /api/setting/setKeymap
     - /api/setting/setPublish
     // ... (list of 53 missing APIs) ...
     - /api/ui/reloadUI
   ‚ö†Ô∏è Êñá‰ª∂ÁªìÊûÑÊ£ÄÊü•ÔºöÂèëÁé∞ 1 ‰∏™Â≠§Á´ãÁöÑÊñáÊ°£Êñá‰ª∂ (‰ª£Á†Å‰∏≠Êó†ÂØπÂ∫î API ÂÆö‰πâ):
     - transactions\transactions.html (Â∞ùËØïÂåπÈÖç: /api/transactions/transactions Êàñ /ws/transactions/transactions)

üìÑ ÂºÄÂßãÊ£ÄÊü•ÂàÜÁªÑÁ¥¢ÂºïÊñá‰ª∂ (index.html)...
   --- ÂØπÊØî‰ª£Á†ÅÂÆö‰πâ‰∏éÁ¥¢ÂºïÊñá‰ª∂ ---
   // ... (consistent index checks omitted for brevity) ...
   ‚úÖ ÊâÄÊúâÂàÜÁªÑÁ¥¢ÂºïÂùá‰∏é‰ª£Á†ÅÂÆö‰πâ‰∏ÄËá¥Ôºå‰∏îÊó†Â≠§Á´ãÁ¥¢Âºï„ÄÇ

üèÅ ÂèåÈáçÊ†°È™åÂÆåÊàê„ÄÇÊÄªÁªìÔºö
   - üî¥ 53 ‰∏™ API Áº∫Â∞ëÂØπÂ∫îÁöÑÊñáÊ°£Êñá‰ª∂„ÄÇ
   - üü° 1 ‰∏™Â≠§Á´ãÁöÑÊñáÊ°£Êñá‰ª∂ÈúÄË¶ÅÊ∏ÖÁêÜ„ÄÇ
   - ‚úÖ Ê≤°ÊúâÂèëÁé∞Â≠§Á´ãÁöÑ index.html Êñá‰ª∂„ÄÇ
   ËØ∑Ê†πÊçÆ‰∏äÈù¢ÁöÑËØ¶ÁªÜÊä•ÂëäËøõË°åÂ§ÑÁêÜ„ÄÇ
PS D:\siyuan\siyuan-kernelApi-docs\scripts>
```

**Next Step:** Process the next missing API: `/api/setting/setKeymap`. 